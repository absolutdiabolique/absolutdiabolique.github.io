<!DOCTYPE html>
<html>
<head>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<title>diabolical text 3D</title>
<style>
  html, body { 
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    background: #0b1220;
    color: #e6eef8;
    font-family: 'Times New Roman', serif;
    overflow: hidden;
    perspective: 1000px; /* for 3D */
  }

  .ui {
    position: fixed;
    top: 5%;
    left: 5%;
    width: 90%;
    height: 10%;
    background: #173063;
    border: 1px solid black;
    border-radius: 12px;
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 8px 16px;
    box-sizing: border-box;
    font-size: 14px;
    z-index: 5;
  }

  select, button {
    background: #0b1220;
    color: #e6eef8;
    border: 1px solid #000;
    border-radius: 6px;
    padding: 4px 8px;
  }

  /* Full container with 3D transform support */
  .ta-container {
    position: fixed;
    width: 90%;
    height: 75%;
    left: 5%;
    top: 20%;
    transform-style: preserve-3d;
    transform-origin: center center;
    cursor: grab;
  }

  .ta-container:active {
    cursor: grabbing;
  }

  /* Wrapper for gradient border */
  .ta-wrap {
    position: relative;
    width: 100%;
    height: 100%;
    border-radius: 12px;
    transform-style: preserve-3d;
  }

  .ta-wrap textarea {
    width: 100%;
    height: 100%;
    background: #173063;
    color: #e6eef8;
    border: 1px solid black;
    border-radius: 12px;
    resize: none;
    padding: 20px;
    box-sizing: border-box;
    font-size: 16px;
    font-family: inherit;
    position: relative;
    z-index: 2;
    transform-style: preserve-3d;
  }

  .ta-wrap:focus-within::before {
    content: "";
    position: absolute;
    inset: -3px;
    border-radius: 14px;
    background: linear-gradient(90deg, magenta, #66ccff, magenta);
    background-size: 300% 300%;
    animation: gradientAnim 3s linear infinite;
    z-index: 1;
    pointer-events: none;
  }

  @keyframes gradientAnim {
    0%   { background-position: 0% 50%; }
    50%  { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  /* Rotator group (handle) */
  .rotator {
    position: absolute;
    top: -45px;
    left: 50%;
    transform: translateX(-50%);
    transform: rotate(0.5turn);
    width: 2px;
    height: 45px;
    display: flex;
    align-items: center;
    flex-direction: column;
    pointer-events: none;
    z-index: 20;
  }

  .rotator-line {
    width: 2px;
    height: 25px;
    background: #66ccff;
  }

  .rotate-handle {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: #66ccff;
    border: 2px solid #0b1220;
    cursor: grab;
    pointer-events: auto; 
  }

  .rotate-handle:active {
    cursor: grabbing;
  }

</style>
</head>
<body>

  <div class="ui">
    <select id="fontSelect">
      <option value="Times New Roman">Times New Roman</option>
      <option value="Arial">Arial</option>
      <option value="'IBM Plex Mono', monospace">IBM Plex Mono</option>
      <option value="Georgia">Georgia</option>
      <option value="'Courier New'">Courier New</option>
    </select>

    <button id="decrease">A-</button>
    <button id="increase">A+</button>
  </div>

  <div class="ta-container" id="taContainer">

    <!-- TEXTAREA -->
    <div class="ta-wrap" id="taWrap">
      <textarea id="editor"></textarea>
    </div>

    <!-- Handle + connector -->
    <div class="rotator" id="rotator">
      <div class="rotator-line"></div>
      <div class="rotate-handle" id="rotateHandle"></div>
    </div>

  </div>

<script>
  const editor = document.getElementById('editor');
  const fontSelect = document.getElementById('fontSelect');
  const inc = document.getElementById('increase');
  const dec = document.getElementById('decrease');

  fontSelect.addEventListener('change', () => {
    editor.style.fontFamily = fontSelect.value;
  });

  inc.addEventListener('click', () => {
    const size = parseInt(window.getComputedStyle(editor).fontSize, 10);
    editor.style.fontSize = (size + 2) + 'px';
  });

  dec.addEventListener('click', () => {
    const size = parseInt(window.getComputedStyle(editor).fontSize, 10);
    editor.style.fontSize = Math.max(size - 2, 6) + 'px';
  });

  /* 3D ROTATION BY DRAGGING BACKGROUND */
  const container = document.getElementById('taContainer');
  let isDragging = false;
  let prevX = 0;
  let prevY = 0;
  let rotX = 0;
  let rotY = 0;

  container.addEventListener('mousedown', (e) => {
    if(e.target === document.getElementById('rotateHandle')) return; // skip handle
    isDragging = true;
    prevX = e.clientX;
    prevY = e.clientY;
  });

  window.addEventListener('mousemove', (e) => {
    if(!isDragging) return;
    const dx = e.clientX - prevX;
    const dy = e.clientY - prevY;
    rotY += dx * 0.5; // horizontal rotation
    rotX -= dy * 0.5; // vertical rotation
    container.style.transform = `rotateX(${rotX}deg) rotateY(${rotY}deg)`;
    prevX = e.clientX;
    prevY = e.clientY;
  });

  window.addEventListener('mouseup', () => {
    isDragging = false;
  });

  /* HANDLE-ONLY ROTATION (around Z axis) */
  const handle = document.getElementById('rotateHandle');
  let rotating = false;
  let startAngle = 0;
  let startRotation = 0;

  function getAngle(e) {
    const rect = container.getBoundingClientRect();
    const cx = rect.left + rect.width / 2;
    const cy = rect.top + rect.height / 2;
    return Math.atan2(e.clientY - cy, e.clientX - cx) * (180 / Math.PI);
  }

  handle.addEventListener('mousedown', (e) => {
    rotating = true;
    startAngle = getAngle(e);
    const transform = window.getComputedStyle(container).transform;
    if (transform !== 'none') {
      const vals = transform.split('(')[1].split(')')[0].split(',');
      const a = parseFloat(vals[0]), b = parseFloat(vals[1]);
      startRotation = Math.atan2(b, a) * (180 / Math.PI);
    } else {
      startRotation = 0;
    }
    e.stopPropagation();
    e.preventDefault();
  });

  window.addEventListener('mousemove', (e) => {
    if (!rotating) return;
    const angle = getAngle(e);
    const delta = angle - startAngle;
    container.style.transform = `rotateX(${rotX}deg) rotateY(${rotY}deg) rotate(${startRotation + delta}deg)`;
  });

  window.addEventListener('mouseup', () => {
    rotating = false;
  });

</script>

</body>
</html>
